<% if @order.errors.present? %>
  errorDiv = $('<div>', {id: 'errorExplanation', class: 'alert alert-danger'});
  heading = $('<p>').text("There were problems with the following fields:");
  errorList = $('<ul>');
  <% @order.errors.messages.each do |key, message| %>
    <% message.each do |error| %>
      list = $('<li>').text("<%=j error %>");
      errorList.append(list);
    <% end %>
  <% end %>
  errorDiv.append(heading, errorList);
  $('div[data-hook="checkout_header"]').append(errorDiv);
  $('input[data-disable-with="Save and Continue"]').removeClass('disabled');
<% else %>
  $('div[data-hook="checkout_form_wrapper"]').hide();
  currentStateDiv = $("form#checkout_form_<%= @order.state %>").parent('div');
  currentStateDiv.show();
  currentStateDiv.find('input#order_state_lock_version').val("<%= @order.state_lock_version.to_s %>");
  $('li.active').removeClass('active').next().addClass('active');
  $('li.active').prevAll().addClass('completed');
<% end %>
